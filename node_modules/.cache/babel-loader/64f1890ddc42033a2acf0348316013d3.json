{"ast":null,"code":"import { onBeforeUnmount, onMounted, watch, ref, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  var open = _ref.open,\n      value = _ref.value,\n      isClickOutside = _ref.isClickOutside,\n      triggerOpen = _ref.triggerOpen,\n      forwardKeydown = _ref.forwardKeydown,\n      _onKeydown = _ref.onKeydown,\n      blurToCancel = _ref.blurToCancel,\n      onSubmit = _ref.onSubmit,\n      onCancel = _ref.onCancel,\n      _onFocus = _ref.onFocus,\n      _onBlur = _ref.onBlur;\n  var typing = ref(false);\n  var focused = ref(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n\n  var preventBlurRef = ref(false);\n  var valueChangedRef = ref(false);\n  var preventDefaultRef = ref(false);\n  var inputProps = computed(function () {\n    return {\n      onMousedown: function onMousedown() {\n        typing.value = true;\n        triggerOpen(true);\n      },\n      onKeydown: function onKeydown(e) {\n        var preventDefault = function preventDefault() {\n          preventDefaultRef.value = true;\n        };\n\n        _onKeydown(e, preventDefault);\n\n        if (preventDefaultRef.value) return;\n\n        switch (e.which) {\n          case KeyCode.ENTER:\n            {\n              if (!open.value) {\n                triggerOpen(true);\n              } else if (onSubmit() !== false) {\n                typing.value = true;\n              }\n\n              e.preventDefault();\n              return;\n            }\n\n          case KeyCode.TAB:\n            {\n              if (typing.value && open.value && !e.shiftKey) {\n                typing.value = false;\n                e.preventDefault();\n              } else if (!typing.value && open.value) {\n                if (!forwardKeydown(e) && e.shiftKey) {\n                  typing.value = true;\n                  e.preventDefault();\n                }\n              }\n\n              return;\n            }\n\n          case KeyCode.ESC:\n            {\n              typing.value = true;\n              onCancel();\n              return;\n            }\n        }\n\n        if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n          triggerOpen(true);\n        } else if (!typing.value) {\n          // Let popup panel handle keyboard\n          forwardKeydown(e);\n        }\n      },\n      onFocus: function onFocus(e) {\n        typing.value = true;\n        focused.value = true;\n\n        if (_onFocus) {\n          _onFocus(e);\n        }\n      },\n      onBlur: function onBlur(e) {\n        if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n          preventBlurRef.value = false;\n          return;\n        }\n\n        if (blurToCancel.value) {\n          setTimeout(function () {\n            var _document = document,\n                activeElement = _document.activeElement;\n\n            while (activeElement && activeElement.shadowRoot) {\n              activeElement = activeElement.shadowRoot.activeElement;\n            }\n\n            if (isClickOutside(activeElement)) {\n              onCancel();\n            }\n          }, 0);\n        } else if (open.value) {\n          triggerOpen(false);\n\n          if (valueChangedRef.value) {\n            onSubmit();\n          }\n        }\n\n        focused.value = false;\n\n        if (_onBlur) {\n          _onBlur(e);\n        }\n      }\n    };\n  }); // check if value changed\n\n  watch(open, function () {\n    valueChangedRef.value = false;\n  });\n  watch(value, function () {\n    valueChangedRef.value = true;\n  });\n  var globalMousedownEvent = ref(); // Global click handler\n\n  onMounted(function () {\n    globalMousedownEvent.value = addGlobalMousedownEvent(function (e) {\n      var target = getTargetFromEvent(e);\n\n      if (open.value) {\n        var clickedOutside = isClickOutside(target);\n\n        if (!clickedOutside) {\n          preventBlurRef.value = true; // Always set back in case `onBlur` prevented by user\n\n          raf(function () {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused: focused,\n    typing: typing\n  }];\n}","map":{"version":3,"names":["onBeforeUnmount","onMounted","watch","ref","computed","KeyCode","addGlobalMousedownEvent","getTargetFromEvent","raf","usePickerInput","_ref","open","value","isClickOutside","triggerOpen","forwardKeydown","_onKeydown","onKeydown","blurToCancel","onSubmit","onCancel","_onFocus","onFocus","_onBlur","onBlur","typing","focused","preventBlurRef","valueChangedRef","preventDefaultRef","inputProps","onMousedown","e","preventDefault","which","ENTER","TAB","shiftKey","ESC","SHIFT","includes","document","activeElement","setTimeout","_document","shadowRoot","globalMousedownEvent","target","clickedOutside"],"sources":["/Users/cinder/Desktop/psyplusweb/node_modules/ant-design-vue/es/vc-picker/hooks/usePickerInput.js"],"sourcesContent":["import { onBeforeUnmount, onMounted, watch, ref, computed } from 'vue';\nimport KeyCode from '../../_util/KeyCode';\nimport { addGlobalMousedownEvent, getTargetFromEvent } from '../utils/uiUtil';\nimport raf from '../../_util/raf';\nexport default function usePickerInput(_ref) {\n  var open = _ref.open,\n      value = _ref.value,\n      isClickOutside = _ref.isClickOutside,\n      triggerOpen = _ref.triggerOpen,\n      forwardKeydown = _ref.forwardKeydown,\n      _onKeydown = _ref.onKeydown,\n      blurToCancel = _ref.blurToCancel,\n      onSubmit = _ref.onSubmit,\n      onCancel = _ref.onCancel,\n      _onFocus = _ref.onFocus,\n      _onBlur = _ref.onBlur;\n  var typing = ref(false);\n  var focused = ref(false);\n  /**\n   * We will prevent blur to handle open event when user click outside,\n   * since this will repeat trigger `onOpenChange` event.\n   */\n\n  var preventBlurRef = ref(false);\n  var valueChangedRef = ref(false);\n  var preventDefaultRef = ref(false);\n  var inputProps = computed(function () {\n    return {\n      onMousedown: function onMousedown() {\n        typing.value = true;\n        triggerOpen(true);\n      },\n      onKeydown: function onKeydown(e) {\n        var preventDefault = function preventDefault() {\n          preventDefaultRef.value = true;\n        };\n\n        _onKeydown(e, preventDefault);\n\n        if (preventDefaultRef.value) return;\n\n        switch (e.which) {\n          case KeyCode.ENTER:\n            {\n              if (!open.value) {\n                triggerOpen(true);\n              } else if (onSubmit() !== false) {\n                typing.value = true;\n              }\n\n              e.preventDefault();\n              return;\n            }\n\n          case KeyCode.TAB:\n            {\n              if (typing.value && open.value && !e.shiftKey) {\n                typing.value = false;\n                e.preventDefault();\n              } else if (!typing.value && open.value) {\n                if (!forwardKeydown(e) && e.shiftKey) {\n                  typing.value = true;\n                  e.preventDefault();\n                }\n              }\n\n              return;\n            }\n\n          case KeyCode.ESC:\n            {\n              typing.value = true;\n              onCancel();\n              return;\n            }\n        }\n\n        if (!open.value && ![KeyCode.SHIFT].includes(e.which)) {\n          triggerOpen(true);\n        } else if (!typing.value) {\n          // Let popup panel handle keyboard\n          forwardKeydown(e);\n        }\n      },\n      onFocus: function onFocus(e) {\n        typing.value = true;\n        focused.value = true;\n\n        if (_onFocus) {\n          _onFocus(e);\n        }\n      },\n      onBlur: function onBlur(e) {\n        if (preventBlurRef.value || !isClickOutside(document.activeElement)) {\n          preventBlurRef.value = false;\n          return;\n        }\n\n        if (blurToCancel.value) {\n          setTimeout(function () {\n            var _document = document,\n                activeElement = _document.activeElement;\n\n            while (activeElement && activeElement.shadowRoot) {\n              activeElement = activeElement.shadowRoot.activeElement;\n            }\n\n            if (isClickOutside(activeElement)) {\n              onCancel();\n            }\n          }, 0);\n        } else if (open.value) {\n          triggerOpen(false);\n\n          if (valueChangedRef.value) {\n            onSubmit();\n          }\n        }\n\n        focused.value = false;\n\n        if (_onBlur) {\n          _onBlur(e);\n        }\n      }\n    };\n  }); // check if value changed\n\n  watch(open, function () {\n    valueChangedRef.value = false;\n  });\n  watch(value, function () {\n    valueChangedRef.value = true;\n  });\n  var globalMousedownEvent = ref(); // Global click handler\n\n  onMounted(function () {\n    globalMousedownEvent.value = addGlobalMousedownEvent(function (e) {\n      var target = getTargetFromEvent(e);\n\n      if (open.value) {\n        var clickedOutside = isClickOutside(target);\n\n        if (!clickedOutside) {\n          preventBlurRef.value = true; // Always set back in case `onBlur` prevented by user\n\n          raf(function () {\n            preventBlurRef.value = false;\n          });\n        } else if (!focused.value || clickedOutside) {\n          triggerOpen(false);\n        }\n      }\n    });\n  });\n  onBeforeUnmount(function () {\n    globalMousedownEvent.value && globalMousedownEvent.value();\n  });\n  return [inputProps, {\n    focused: focused,\n    typing: typing\n  }];\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}